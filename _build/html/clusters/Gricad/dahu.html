
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Connect to Gricad clusters &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'clusters/Gricad/dahu';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Computing for IGE users exclusively
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fclusters/Gricad/dahu.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/clusters/Gricad/dahu.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Connect to Gricad clusters</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Connect to Gricad clusters</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#running-jobs-on-gricad-clusters">Running jobs on Gricad clusters</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#storage-on-gricad-clusters">Storage on Gricad clusters</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#elmer-usage-on-gricad-clusters">Elmer usage on Gricad clusters</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="connect-to-gricad-clusters">
<h1>Connect to Gricad clusters<a class="headerlink" href="#connect-to-gricad-clusters" title="Link to this heading">#</a></h1>
<p>More details about Griccad infrastructure are available here:</p>
<p><strong><a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/">https://gricad-doc.univ-grenoble-alpes.fr/hpc/</a></strong></p>
<p><strong>Get your account on Gricad</strong></p>
<p>If you have an <strong>agalan</strong> login/password</p>
<p><a class="reference external" href="https://perseus.univ-grenoble-alpes.fr/create-account/portal-agalan">https://perseus.univ-grenoble-alpes.fr/create-account/portal-agalan</a></p>
<p>if not, create an external account with the email from your institution (private email &#64;gmail/&#64;yahoo are not allowed)</p>
<p><a class="reference external" href="https://perseus.univ-grenoble-alpes.fr/create-account/form">https://perseus.univ-grenoble-alpes.fr/create-account/form</a></p>
<p>Once you created your account, you should receive an email from perseus that asks you to validate your account with a <strong>KEY</strong> provided in the email</p>
<p>Connect again to perseus and enter the provided <strong>KEY</strong> et it should be ok.</p>
<p>It should take 1 day to get your account activated. If you nee a rapid accesss, feel free to contact <strong>mondher.chekki&#64;XXXXX</strong></p>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>graph TD;
A[f-dahu] --&gt; B(dahu33);
A --&gt; C(........);
A --&gt; D(dahu192);
A --&gt; E(dahu-fat1);
A --&gt; F(............);
A --&gt; G(dahu-fat4);
A --&gt; H(dahu-visu);
</pre></div>
</div>
<p><strong>Create an ssh key</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span>
</pre></div>
</div>
<p>Type <strong>Enter</strong> twice WITHOUT ENTERING ANY PASSWORD and you should have two keys in <strong>$HOME/.ssh</strong></p>
<p>a private key: id_rsa<br />
a public key : id_rsa.pub</p>
<p><strong>Create config file</strong></p>
<p>Then create the <strong>$HOME/.ssh/config</strong> file on your computer , in which you must enter the bastion and server information for the connection.</p>
<p>replace login_gricad with yours</p>
<p>For Dahu server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Host</span> <span class="n">dahu</span>  
<span class="n">ProxyCommand</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">qX</span> <span class="n">login_gricad</span><span class="nd">@trinity</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">ga</span><span class="o">.</span><span class="n">fr</span> <span class="n">nc</span> <span class="mf">129.88.197.54</span> <span class="mi">22</span>  
<span class="n">User</span> <span class="n">login_gricad</span>  
<span class="n">GatewayPorts</span> <span class="n">yes</span>
</pre></div>
</div>
<p>Next, you need to set the correct rights:</p>
<p><strong>chmod ugo-rwx .ssh/config</strong><br />
<strong>chmod u+rw .ssh/config</strong></p>
<p>keep read/write rights only for the user and the private key: id_rsa</p>
<p>Then, copy the ssh keys</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">copy</span><span class="o">-</span><span class="nb">id</span> <span class="n">login_gricad</span><span class="nd">@trinity</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">ga</span><span class="o">.</span><span class="n">fr</span> 
</pre></div>
</div>
<p>Enter the agalan passwod</p>
<p>then</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">copy</span><span class="o">-</span><span class="nb">id</span> <span class="n">dahu</span>
</pre></div>
</div>
<p>Enter the agalan password</p>
<p>and you should be good for future sessions.</p>
<p>Now, to connect, just type</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">dahu</span>
</pre></div>
</div>
</section>
<section id="running-jobs-on-gricad-clusters">
<h1>Running jobs on Gricad clusters<a class="headerlink" href="#running-jobs-on-gricad-clusters" title="Link to this heading">#</a></h1>
<p>Once you are connected to dahu, you will be able to run jobs with the scheduler named OAR</p>
<p>An introduction to OAR is described here</p>
<p><a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/joblaunch/job_management">https://gricad-doc.univ-grenoble-alpes.fr/hpc/joblaunch/job_management</a></p>
<p>Basically, to perform computations, you don’t have to do them on the server you’re connected to (front-end), but on other servers (compute nodes) accessible from the front-end.</p>
<p>Hence you need to use a job scheduler (OAR) to launch calculations on the nodes.</p>
<p>For example, let’s say that you need to run R calculations on the server</p>
<p>To install R packages</p>
<p>Either use <strong>nix/guix</strong> environement</p>
<p><strong>Nix:</strong>
<a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/softenv/nix/#r-packages">https://gricad-doc.univ-grenoble-alpes.fr/hpc/softenv/nix/#r-packages</a></p>
<p><strong>Guix:</strong>
<a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/softenv/guix/">https://gricad-doc.univ-grenoble-alpes.fr/hpc/softenv/guix/</a></p>
<p>Or <strong>conda/micromamba</strong> : <strong>micromamba</strong> is faster</p>
<p><img alt="Using micromamba to set up your python environement" src="../../_images/micromamba.md" /></p>
<p>Here’s an example of a job header:
Change the name of project to your project</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat job_exemple.oar
  
#!/bin/bash  
#OAR -n Test_job  
#OAR -O Test_job.%jobid%.o  
#OAR -E Test_job.%jobid%.e  
#OAR --project sno-elmerice
#OAR -l nodes=1/core=1,walltime=01:30:00  
  
cd YOUR_WORKING_DIRECTORY
micromamba activate Renv

R CMD BATCH ....
or
Rscript ....

</pre></div>
</div>
<p><strong>Description:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#OAR -l nodes=1/core=1,walltime=01:30:00</span>
</pre></div>
</div>
<p>Launch of a job, on a single computing core for 1h30 (possibility of increasing core=1 a plus when using MPI)<br />
The project on which the hours will be used is sno-elmerice</p>
<p>The results will be written to two files</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#OAR -O Test_job.NUMERO_JOB.o (standart output)  </span>
<span class="c1">#OAR -E Test_job.NUMERO_JOB.o (standart error)</span>
</pre></div>
</div>
<p>If you want to use the fat nodes, just add this to your script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#OAR -t fat</span>
</pre></div>
</div>
<p>If you need to use immediatly the node  without waiting add this  (yo need to asked for a walltime less than 30 minutes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#OAR -t devel</span>
</pre></div>
</div>
<p><strong>Memory</strong>
You have different type of nodes with different features (use <a class="reference external" href="http://recap.py">recap.py</a>  to see all of them). The memory you are using in a job is equal to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_cores_asked</span> <span class="n">x</span> <span class="p">(</span> <span class="n">total_mem</span><span class="o">/</span><span class="n">n_cores</span><span class="p">)</span>
</pre></div>
</div>
<p>If  you want the whole memory, you should asked for all available cores (n_cores)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[f-dahu /home/chekkim ]$ recap.py  
========================================================================================  
| node | cpumodel |n_cpus n_cores| scratch1_type | hasgpu |  
| | | total_mem| scratch2_type | |  
========================================================================================  
| dahu33 | Gold 6130 | 2 | 16 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| dahu34 | Gold 6130 | 2 | 32 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| [ + 37 more node(s) ] |  
| dahu72 | Gold 6130 | 2 | 32 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| dahu73 | Gold 6126 | 2 | 24 | 192 |system_ssd | dedicated_hdd | NO |  
| [ + 2 more node(s) ] |  
| dahu76 | Gold 6126 | 2 | 24 | 192 |system_ssd | dedicated_hdd | NO |  
| dahu77 | Gold 6126 | 2 | 24 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| [ + 3 more node(s) ] |  
| dahu81 | Gold 6126 | 2 | 24 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| dahu82 | Gold 6130 | 2 | 32 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| [ + 23 more node(s) ] |  
| dahu106 | Gold 6130 | 2 | 32 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| dahu107 | Gold 6130 | 2 | 32 | 192 |dedicated_ssd | none | NO |  
| dahu108 | Gold 5218 | 2 | 32 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| dahu109 | Gold 5218 | 2 | 32 | 192 |dedicated_ssd | dedicated_hdd | NO |  
| dahu110 | Gold 6244 | 2 | 16 | 192 |dedicated_ssd | none | NO |  
| dahu111 | Gold 6244 | 2 | 16 | 192 |dedicated_ssd | none | NO |  
  
| dahu142 | Gold 5218 | 2 | 32 | 192 |dedicated_hdd | none | NO |  
| dahu143 | Gold 5218 | 2 | 32 | 192 |dedicated_hdd | none | NO |  
| dahu144 | Gold 5318Y| 2 | 48 | 256 |system_ssd | none | NO |  
| [ + 47 more node(s) ] |  
| dahu192 | Gold 5318Y| 2 | 48 | 256 |system_ssd | none | NO |  
| dahu-fat1| Gold 6244 | 2 | 16 |1500 |dedicated_raid0_ssd | dedicated_raid5_hdd| NO |  
| dahu-fat2| Gold 6244 | 2 | 16 |1500 |dedicated_ssd | dedicated_hdd | NO |  
| [ + 1 more node(s) ] |  
| dahu-fat4| Gold 6244 | 2 | 16 |1500 |dedicated_ssd | dedicated_hdd | NO |  
| dahu-visu| Silver 4216| 2 | 32 | 192 |system_hdd | none | NO |  
========================================================================================
</pre></div>
</div>
<p>To run the job in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chmod</span> <span class="mi">750</span> <span class="n">job_exemple</span><span class="o">.</span><span class="n">oar</span>  
<span class="n">oarsub</span> <span class="o">-</span><span class="n">S</span> <span class="o">./</span><span class="n">job_exemple</span><span class="o">.</span><span class="n">oar</span>
</pre></div>
</div>
<p><strong>Use the interactive mode</strong></p>
<p>If you are developping a code, it is better to have acces to a node for debugging issues. In the passive mode , if you make a small mistake , then you  have to submit your job again and wait in the queue.
Using the interactive mode allows to correct your mistake and run your code until you make sure that everything is working fine.</p>
<p>To do that use <strong>oarsub</strong> with <strong>-I</strong> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oarsub</span> <span class="o">-</span><span class="n">I</span> <span class="o">-</span><span class="n">l</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">core</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">walltime</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span> <span class="o">--</span><span class="n">project</span> <span class="n">sno</span><span class="o">-</span><span class="n">elmerice</span> 
</pre></div>
</div>
<p>for devel mode</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oarsub</span> <span class="o">-</span><span class="n">I</span> <span class="o">-</span><span class="n">l</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">core</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">walltime</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span> <span class="o">--</span><span class="n">project</span> <span class="n">sno</span><span class="o">-</span><span class="n">elmerice</span> <span class="o">-</span><span class="n">t</span> <span class="n">devel</span>
</pre></div>
</div>
<p>for fat nodes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oarsub</span> <span class="o">-</span><span class="n">I</span> <span class="o">-</span><span class="n">l</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">core</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">walltime</span><span class="o">=</span><span class="mi">04</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span> <span class="o">--</span><span class="n">project</span> <span class="n">sno</span><span class="o">-</span><span class="n">elmerice</span> <span class="o">-</span><span class="n">t</span> <span class="n">fat</span>
</pre></div>
</div>
<p><strong>Job Stats with OAR</strong></p>
<p>Once your job is finished or in case it stops without any reasons, you can check the dashborad</p>
<blockquote>
<div><p>:warning: <strong>Replace MYJOBID with your JOBID</strong></p>
</div></blockquote>
<p><a class="reference external" href="https://gricad-dashboards.univ-grenoble-alpes.fr/d/RUyeEaIGz/colmet-dahu-jobs-stats?orgId=1&amp;amp;refresh=1h&amp;amp;var-Job_ID=**MYJOBID**&amp;amp;var-Node=All&amp;amp;from=now-24h&amp;amp;to=now">https://gricad-dashboards.univ-grenoble-alpes.fr/d/RUyeEaIGz/colmet-dahu-jobs-stats?orgId=1&amp;refresh=1h&amp;var-Job_ID=**MYJOBID**&amp;var-Node=All&amp;from=now-24h&amp;to=now</a></p>
<p>Here is an example of Memory usage for different nodes</p>
<p><img alt="Dashbord Memory usage example" src="../../_images/nodedahu153RSS.PNG" /></p>
</section>
<section id="storage-on-gricad-clusters">
<h1>Storage on Gricad clusters<a class="headerlink" href="#storage-on-gricad-clusters" title="Link to this heading">#</a></h1>
<p><strong>Workdir/Datastorage on dahu</strong></p>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>graph TD;
A[dahu node] --&gt; B(/bettik);
A --&gt; C(/silenus);
A --&gt; D(/mantis);
</pre></div>
</div>
<p>You have access to the $HOME(/home/your_login), which is a limited space under quota (50GB max).</p>
<p>You must work on /bettik/login_gricad,  /bettik/PROJECTS/PROJECT_NAME/login_gricad or /bettik/PROJECTS/PROJECT_NAME/COMMON if you want to share you data/code between the members of the project</p>
<p>Bettik is a parallel filesystem so it is very fast when it comes to write/read data by the same program with different tasks</p>
<p>This space is accessible to all nodes.</p>
<p>More info on Gricad Website</p>
<p><a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/bettik/">https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/bettik/</a></p>
<p>To copy data from your PC to /bettik, use the rsync command.</p>
<p>Let’s assume we have a folder: Data_Model</p>
<p>We’d like to copy this folder to /bettik/login_gricad in order to use the data.</p>
<p>The copy is made with the command rsync:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="o">-</span><span class="n">rav</span> <span class="n">Data_Model</span> <span class="n">dahu</span><span class="p">:</span><span class="o">/</span><span class="n">bettik</span><span class="o">/</span><span class="n">login_gricad</span><span class="o">/</span>  
</pre></div>
</div>
<p>To copy data from dahu to your PC:</p>
<p>( be careful there’s the dot . which means copy here)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="o">-</span><span class="n">rav</span> <span class="n">dahu</span><span class="p">:</span><span class="o">/</span><span class="n">bettik</span><span class="o">/</span><span class="n">login_gricad</span><span class="o">/</span><span class="n">Dossier_bettik</span> <span class="o">.</span>  
</pre></div>
</div>
<p>If you have a local folder called Local_folder to which you want to copy data from /bettik</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="o">-</span><span class="n">rav</span> <span class="n">dahu</span><span class="p">:</span><span class="o">/</span><span class="n">bettik</span><span class="o">/</span><span class="n">login_gricad</span><span class="o">/</span><span class="n">Dossier_bettik</span><span class="o">/</span> <span class="n">Local_folder</span><span class="o">/</span>
</pre></div>
</div>
<blockquote>
<div><p>:warning: if you want to transfer huge data or a lot of files use mantis-cargo instead</p>
</div></blockquote>
<p><a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/data_transfer/">https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/data_transfer/</a></p>
<p>Replace dahu per <a class="reference external" href="http://mantis-cargo.u-ga.fr">mantis-cargo.u-ga.fr</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="o">-</span><span class="n">rav</span> <span class="n">Data_Model</span> <span class="n">login_gricad</span><span class="nd">@mantis</span><span class="o">-</span><span class="n">cargo</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">ga</span><span class="o">.</span><span class="n">fr</span><span class="p">:</span><span class="o">/</span><span class="n">bettik</span><span class="o">/</span><span class="n">login_gricad</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Other Datastorage available  on dahu: /silenus and /mantis</strong></p>
<p>Silenus is a parallel filesystem composed of SSD so it is very fast but consider this as a scratch as the files will be automatically deleted when they reach 60 days old.</p>
<p><a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/silenus/">https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/silenus/</a></p>
<p>So If you need to save them, you have  to copy them to /bettik workdir for short term preservation(&lt;1an), or to the Mantis2 cloud storage for long term preservation(&lt;5ans).</p>
<blockquote>
<div><p>:warning:  if your files are only accessed in read mode, and you still use them, you
should do a <code class="docutils literal notranslate"><span class="pre">touch</span> <span class="pre">&lt;file&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">touch</span> <span class="pre">-r</span> <span class="pre">&lt;directory&gt;</span></code> to update the change time as
HPC scratches do not update the access time.
Otherwise, they may be deleted 60 days after their creation.</p>
</div></blockquote>
<p>Mantis is a cloud storage used for long term preservation</p>
<p><strong>First usage of mantis</strong></p>
<p>Copy this file to your $HOME/.irods directory on dahu, keep the same name  and put your login instead of chekkim</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[f-dahu  /home/chekkim ]$  more .irods/irods_environment.json
{
        &quot;irods_host&quot;: &quot;mantis.u-ga.fr&quot;,
        &quot;irods_port&quot;: 1247,
        &quot;irods_user_name&quot;: &quot;chekkim&quot;,
        &quot;irods_zone_name&quot;: &quot;mantis&quot;,
        &quot;irods_authentication_scheme&quot;: &quot;PAM&quot;,
        &quot;irods_ssl_ca_certificate_file&quot;: &quot;/etc/irods/chain.pem&quot;,
        &quot;irods_ssl_verify_server&quot;: &quot;cert&quot;
}
</pre></div>
</div>
<p>and then connect using iinit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>f-dahu  /home/chekkim ]$  iinit
Enter your current PAM password:
[f-dahu  /home/chekkim ]$  ils
/mantis/home/chekkim:
  bench_v1.tar
  elmerscalasca.tar
  netcdf-cxx4-4.3.1.tar.gz
  C- /mantis/home/chekkim/MARin
  C- /mantis/home/chekkim/input
  C- /mantis/home/chekkim/python
</pre></div>
</div>
<p>Enter your agalan password and you should be able to copy/get files to your mantis workspace using iget and iput commands</p>
<p>More details , here:</p>
<p><a class="reference external" href="https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/mantis/">https://gricad-doc.univ-grenoble-alpes.fr/hpc/data_management/mantis/</a></p>
<p><strong>/home OR /bettik OR /silenus OR /mantis , how to choose</strong></p>
<p><strong>/home</strong> you should put here all your scripts, code in python/bash/fortran/R and you should manage to save them (the /home is no longer saved)
You should also think about using github or <a class="reference external" href="https://gricad-gitlab.univ-grenoble-alpes.fr/users/sign_in">Gricad gitlab</a> to commit you changes and keep your codes up to date</p>
<p><strong>/bettik</strong> should be used by default  for all your simulations as you have a large quota and your data is not cleaned.</p>
<p><strong>/silenus</strong> should be tested with your workflow and see if the access to data is faster and  in this case re-organise you workflow to move your data older than 60 days from silenus</p>
<p><strong>/mantis</strong>  is used in case you have <strong>cold data</strong> on /bettik that you are not going to use for a while ( let say &lt; 6 months) but you need this data for future simulations</p>
</section>
<section id="elmer-usage-on-gricad-clusters">
<h1>Elmer usage on Gricad clusters<a class="headerlink" href="#elmer-usage-on-gricad-clusters" title="Link to this heading">#</a></h1>
<p>Once connect to dahu, first install the intel compilers</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">applis</span><span class="o">/</span><span class="n">site</span><span class="o">/</span><span class="n">nix_nur</span><span class="o">.</span><span class="n">sh</span>
<span class="n">nix</span><span class="o">-</span><span class="n">env</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">A</span> <span class="n">nur</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">gricad</span><span class="o">.</span><span class="n">intel</span><span class="o">-</span><span class="n">oneapi</span>
</pre></div>
</div>
<p>In case the previous command does not work, or generates erros , you can install intel compilers from my profile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nix</span><span class="o">-</span><span class="n">env</span> <span class="o">-</span><span class="n">i</span> <span class="o">--</span><span class="n">from</span><span class="o">-</span><span class="n">profile</span> <span class="o">/</span><span class="n">nix</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">nix</span><span class="o">/</span><span class="n">profiles</span><span class="o">/</span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">chekkim</span><span class="o">/</span><span class="n">env_inteloneapi</span> <span class="n">intel</span><span class="o">-</span><span class="n">oneapi</span>
</pre></div>
</div>
<p>Once the intel compilers installed, in order to use them</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">applis</span><span class="o">/</span><span class="n">site</span><span class="o">/</span><span class="n">nix_nur</span><span class="o">.</span><span class="n">sh</span>
<span class="n">source</span> <span class="o">~/.</span><span class="n">nix</span><span class="o">-</span><span class="n">profile</span><span class="o">/</span><span class="n">setvars</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>
</div>
<p>In order to load Elmer modules , you have to put this on a config file <strong><a class="reference external" href="http://myconfig.sh">myconfig.sh</a></strong> or in your <strong>$HOME/.bashrc</strong> and source it each time you need to use it</p>
<blockquote>
<div><p>:warning: If you put this in your .bashrc , it will be sourced automatically but may create conflict with other applications</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">applis</span><span class="o">/</span><span class="n">site</span><span class="o">/</span><span class="n">nix_nur</span><span class="o">.</span><span class="n">sh</span>
<span class="n">source</span> <span class="o">~/.</span><span class="n">nix</span><span class="o">-</span><span class="n">profile</span><span class="o">/</span><span class="n">setvars</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
 <span class="o">.</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">chekkim</span><span class="o">/</span><span class="n">LibGlace</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">modules_rev4401cc7d_gnu6</span><span class="mf">.3.0</span><span class="o">/</span><span class="n">init</span><span class="o">/</span><span class="n">bash</span>
<span class="n">export</span> <span class="n">MODULEPATH</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">chekkim</span><span class="o">/</span><span class="n">LibGlace</span><span class="o">/</span><span class="n">modulefiles</span>
<span class="n">module</span> <span class="n">load</span>  <span class="n">netcdf</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="mf">4.7.2</span><span class="n">_intel21_hdf5_MPIO</span>  <span class="n">xios</span><span class="o">/</span><span class="n">xios</span><span class="o">-</span><span class="mf">2.0</span><span class="n">_rev2320_intel21</span>    <span class="n">elmerfem</span><span class="o">/</span><span class="n">elmerfem</span><span class="o">-</span><span class="mi">22</span><span class="n">c2e6b30_intel21</span>
</pre></div>
</div>
<p>then</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>source $HOME/.bashrc
or
source  myconfig.sh
</pre></div>
</div>
<p>For the intel compilers you need to add this in your <strong>$HOME/.bashrc</strong> file in order to avoid seg fault errors when running jobs across nodes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ulimit</span> <span class="o">-</span><span class="n">s</span> <span class="n">unlimited</span>
</pre></div>
</div>
<p>And it should be ok. In order to acces other versions of elmer you can check it with the command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">avail</span> <span class="n">elmerfem</span>
</pre></div>
</div>
<p>In order to get rid of the old module, you need to modify your <strong>$HOME/.bashrc</strong> or your config file</p>
<p>In order to test it on a terminal:  this will not change the version you put on the <strong>$HOME/.bashrc</strong> or config file, but only affects the terminal you are using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">unload</span> <span class="n">elmerfem</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">elmerfem</span><span class="o">/</span><span class="n">elmerfem</span><span class="o">-</span><span class="n">XXXXX</span>
<span class="ow">or</span>
<span class="n">module</span> <span class="n">switch</span> <span class="n">old_module_name</span>  <span class="n">new_module_name</span>
</pre></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./clusters/Gricad"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Connect to Gricad clusters</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#running-jobs-on-gricad-clusters">Running jobs on Gricad clusters</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#storage-on-gricad-clusters">Storage on Gricad clusters</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#elmer-usage-on-gricad-clusters">Elmer usage on Gricad clusters</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>